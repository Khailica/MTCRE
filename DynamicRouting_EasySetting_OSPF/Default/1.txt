# oct/20/2021 17:58:12 by RouterOS 6.48.5
# software id = 
#
#
#
/interface ethernet
set [ find default-name=ether1 ] disable-running-check=no name=ether1-clockwise
set [ find default-name=ether2 ] disable-running-check=no name=ether2-diagonal
set [ find default-name=ether3 ] disable-running-check=no name=ether3-anticlockwise
set [ find default-name=ether4 ] disable-running-check=no name=ether4-LAN
set [ find default-name=ether5 ] disable-running-check=no
set [ find default-name=ether6 ] disable-running-check=no
set [ find default-name=ether7 ] disable-running-check=no
set [ find default-name=ether8 ] disable-running-check=no
set [ find default-name=ether9 ] disable-running-check=no name=ether9-INTERNET
set [ find default-name=ether10 ] disable-running-check=no name=ether10-management
/interface wireless security-profiles
set [ find default=yes ] supplicant-identity=MikroTik
/ip address
add address=1.1.1.1/24 interface=ether1-clockwise network=1.1.1.0
add address=4.4.4.1/24 interface=ether3-anticlockwise network=4.4.4.0
add address=5.5.5.1/24 interface=ether2-diagonal network=5.5.5.0
/ip firewall mangle
add action=mark-routing chain=prerouting disabled=yes in-interface=ether1-clockwise new-routing-mark=backup-route passthrough=yes
/ip firewall nat
add action=src-nat chain=srcnat out-interface=ether1-clockwise src-address=10.10.10.0/24 to-addresses=1.1.1.1
add action=src-nat chain=srcnat out-interface=ether2-diagonal src-address=10.10.10.0/24 to-addresses=5.5.5.1
add action=src-nat chain=srcnat out-interface=ether3-anticlockwise src-address=10.10.10.0/24 to-addresses=4.4.4.1
/routing ospf network
add area=backbone network=1.1.1.0/24
add area=backbone network=4.4.4.0/24
add area=backbone network=5.5.5.0/24
add area=backbone network=10.10.10.0/24
/system identity
set name=R1
/system script
add dont-require-permissions=no name=BackUp owner=admin policy=ftp,reboot,read,write,policy,test,password,sniff,sensitive,romon source=":log info \"Executing of backup script started\";\r\
    \n:local sysname [/system identity get name];\r\
    \n:local sysver [/system package get system version];\r\
    \n/ip dns cache flush;\r\
    \n:delay 2;\r\
    \n:log info \"DNS cache flushed\";\r\
    \n:foreach i in=[/file find] do={:if ([:typeof [:find [/file get \$i name] \"\$sysname-backup-\"]]!=\"nil\") do={/file remove \$i}};\r\
    \n:delay 2;\r\
    \n:log info \"Last backup and export files deleted\";\r\
    \n\r\
    \n:local backupfile (\"\$sysname-backup-\" . [:pick [/system clock get date] 7 11] . [:pick [/system clock get date] 0 3] . [:pick [/system clock get date] 4 6] . \".backup\");\r\
    \n/system backup save name=\$backupfile;\r\
    \n:delay 5;\r\
    \n:log info \"Backup file created\";\r\
    \n:local exportfile (\"\$sysname-backup-\" . [:pick [/system clock get date] 7 11] . [:pick [/system clock get date] 0 3] . [:pick [/system clock get date] 4 6] . \".rsc\");\r\
    \n/export file=\$exportfile;\r\
    \n:delay 5;\r\
    \n:log info \"Export file created\";\r\
    \n:local files {\$backupfile;\$exportfile};"
